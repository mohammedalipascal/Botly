# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Upsun Configuration - WhatsApp Bot
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

applications:
  whatsapp-bot:
    # Ù†ÙˆØ¹ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
    source:
      root: /
    
    # Node.js version
    type: nodejs:20
    
    # Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙˆÙŠØ¨
    web:
      commands:
        start: "node index.js"
      
      upstream:
        socket_family: tcp
        protocol: http
      
      locations:
        "/":
          root: ""
          passthru: true
          allow: false
    
    # Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¯Ø§Ø¦Ù…
    mounts:
      auth_info:
        source: storage
        source_path: auth_info
      logs:
        source: storage
        source_path: logs
    
    # Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø¨Ù†Ø§Ø¡ ÙˆØ§Ù„Ù†Ø´Ø±
    hooks:
      build: |
        set -e
        echo "ğŸ“¦ Installing dependencies..."
        npm ci --only=production
        echo "âœ… Build complete!"
      
      deploy: |
        set -e
        echo "ğŸš€ Deploying WhatsApp Bot..."
        echo "âœ… Deployment successful!"
    
    # Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙŠØ¦Ø©
    variables:
      env:
        NODE_ENV: production
        PORT: 8080

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Routes Configuration
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

routes:
  "https://{default}/":
    type: upstream
    upstream: "whatsapp-bot:http"
    cache:
      enabled: false
  
  "https://www.{default}/":
    type: redirect
    to: "https://{default}/"
